<h2>Miscellaneous Node Helpers</h2><ul>
<li><a href="#api_nan_asyncresource"><b><code>Nan::AsyncResource</code></b></a></li>
<li><a href="#api_nan_make_callback"><b><code>Nan::MakeCallback()</code></b></a></li>
<li><a href="#api_nan_module_init"><b><code>NAN_MODULE_INIT()</code></b></a></li>
<li><a href="#api_nan_export"><b><code>Nan::Export()</code></b></a></li>
</ul>
<p><a name="api_nan_asyncresource"></a></p>
<h3>Nan::AsyncResource</h3><p>This class is analogous to the <code>AsyncResource</code> JavaScript class exposed by Node&#39;s <a href="https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html">async_hooks</a> API.</p>
<p>When calling back into JavaScript asynchornously, special care must be taken to ensure that the runtime can properly track
async hops. <code>Nan::AsyncResource</code> is a class that provides an RAII wrapper around <code>node::EmitAsyncInit</code>, <code>node::EmitAsyncDestroy</code>,
and <code>node::MakeCallback</code>. Using this mechanism to call back into JavaScript, as opposed to <code>Nan::MakeCallback</code> or
<code>v8::Function::Call</code> ensures that the callback is executed in the correct async context. This ensures that async mechanisms
such as domains and <a href="https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html">async_hooks</a> function correctly.</p>
<p>Definition:</p>
<pre><code class="language-c++">class AsyncResource {
 public:
  AsyncResource(v8::Local&lt;v8::String&gt; name,
                v8::Local&lt;v8::Object&gt; resource = New&lt;v8::Object&gt;());
  AsyncResource(const char* name,
                v8::Local&lt;v8::Object&gt; resource = New&lt;v8::Object&gt;());
  ~AsyncResource();

  v8::MaybeLocal&lt;v8::Value&gt; runInAsyncScope(v8::Local&lt;v8::Object&gt; target,
                                            v8::Local&lt;v8::Function&gt; func,
                                            int argc,
                                            v8::Local&lt;v8::Value&gt;* argv);
  v8::MaybeLocal&lt;v8::Value&gt; runInAsyncScope(v8::Local&lt;v8::Object&gt; target,
                                            v8::Local&lt;v8::String&gt; symbol,
                                            int argc,
                                            v8::Local&lt;v8::Value&gt;* argv);
  v8::MaybeLocal&lt;v8::Value&gt; runInAsyncScope(v8::Local&lt;v8::Object&gt; target,
                                            const char* method,
                                            int argc,
                                            v8::Local&lt;v8::Value&gt;* argv);
};
</code></pre>
<ul>
<li><code>name</code>: Identifier for the kind of resource that is being provided for diagnostics information exposed by the <a href="https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html">async_hooks</a>
API. This will be passed to the possible <code>init</code> hook as the <code>type</code>. To avoid name collisions with other modules we recommend
that the name include the name of the owning module as a prefix. For example <code>mysql</code> module could use something like
<code>mysql:batch-db-query-resource</code>.</li>
<li><code>resource</code>: An optional object associated with the async work that will be passed to the possible <a href="https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html">async_hooks</a>
<code>init</code> hook. If this parameter is omitted, or an empty handle is provided, this object will be created automatically.</li>
<li>When calling JS on behalf of this resource, one can use <code>runInAsyncScope</code>. This will ensure that the callback runs in the
correct async execution context.</li>
<li><code>AsyncDestroy</code> is automatically called when an AsyncResource object is destroyed.</li>
</ul>
<p>For more details, see the Node <a href="https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html">async_hooks</a> documentation. You might also want to take a look at the documentation for the
<a href="https://nodejs.org/dist/latest-v9.x/docs/api/n-api.html#n_api_custom_asynchronous_operations">N-API counterpart</a>. For example usage, see the <code>asyncresource.cpp</code> example in the <code>test/cpp</code> directory.</p>
<p><a name="api_nan_make_callback"></a></p>
<h3>Nan::MakeCallback()</h3><p>Deprecated wrappers around the legacy <code>node::MakeCallback()</code> APIs. Node.js 10+
has deprecated these legacy APIs as they do not provide a mechanism to preserve
async context.</p>
<p>We recommend that you use the <code>AsyncResource</code> class and <code>AsyncResource::runInAsyncScope</code> instead of using <code>Nan::MakeCallback</code> or
<code>v8::Function#Call()</code> directly. <code>AsyncResource</code> properly takes care of running the callback in the correct async execution
context â€“ something that is essential for functionality like domains, async_hooks and async debugging.</p>
<p>Signatures:</p>
<pre><code class="language-c++">NAN_DEPRECATED
v8::Local&lt;v8::Value&gt; Nan::MakeCallback(v8::Local&lt;v8::Object&gt; target,
                                       v8::Local&lt;v8::Function&gt; func,
                                       int argc,
                                       v8::Local&lt;v8::Value&gt;* argv);
NAN_DEPRECATED
v8::Local&lt;v8::Value&gt; Nan::MakeCallback(v8::Local&lt;v8::Object&gt; target,
                                       v8::Local&lt;v8::String&gt; symbol,
                                       int argc,
                                       v8::Local&lt;v8::Value&gt;* argv);
NAN_DEPRECATED
v8::Local&lt;v8::Value&gt; Nan::MakeCallback(v8::Local&lt;v8::Object&gt; target,
                                       const char* method,
                                       int argc,
                                       v8::Local&lt;v8::Value&gt;* argv);
</code></pre>
<p><a name="api_nan_module_init"></a></p>
<h3>NAN_MODULE_INIT()</h3><p>Used to define the entry point function to a Node add-on. Creates a function with a given <code>name</code> that receives a <code>target</code> object representing the equivalent of the JavaScript <code>exports</code> object.</p>
<p>See example below.</p>
<p><a name="api_nan_export"></a></p>
<h3>Nan::Export()</h3><p>A simple helper to register a <code>v8::FunctionTemplate</code> from a JavaScript-accessible method (see <a href="./methods.md">Methods</a>) as a property on an object. Can be used in a way similar to assigning properties to <code>module.exports</code> in JavaScript.</p>
<p>Signature:</p>
<pre><code class="language-c++">void Export(v8::Local&lt;v8::Object&gt; target, const char *name, Nan::FunctionCallback f)
</code></pre>
<p>Also available as the shortcut <code>NAN_EXPORT</code> macro.</p>
<p>Example:</p>
<pre><code class="language-c++">NAN_METHOD(Foo) {
  ...
}

NAN_MODULE_INIT(Init) {
  NAN_EXPORT(target, Foo);
}
</code></pre>
